{% extends "base.html" %}

{% block title %}Dataset  {{ dataset.id }} Â· Banana{% endblock title %}

{% block navdatabase %}<li><a href="{% url 'datasets' db_name %}">Database {{ db_name }}</a></li>{% endblock navdatabase %}
{% block navdataset %}<li class="active"><a href="{% url 'dataset' db_name dataset.id %}">Dataset {{ dataset.id }}</a></li>{% endblock navdataset %}

{% block content %}

<div class="row">
    <div class="span4">
        <dl class="dl-horizontal">
            <dt>Dataset ID</dt>
            <dd>{{ dataset.id }}</dd>

            <dt>Description</dt>
            <dd>{{ dataset.description }}</dd>

            <dt>Reprocessing step</dt>
            <dd>{{ dataset.rerun }}</dd>

            <dt>Processing finished</dt>
            <dd>{{ dataset.process_ts }}</dd>

            <dt>detected transients</dt>
            <dd><a href="{% url 'transients' db_name%}?dataset={{ dataset.id }}">{{ dataset.transients.all.count }}</a></dd>

            <dt>available images</dt>
            <dd><a href="{% url 'images' db_name%}?dataset={{ dataset.id }}">{{ dataset.images.all.count }}</a></dd>

            <dt>unique sources</dt>
            <dd>{{ dataset.num_runningcatalogs }}</dd>

            <dt>detected sources</dt>
            <dd>{{ dataset.num_extractedsources }}</dd>

            <dt><a href="monitoringlist">monitoringlist</a></dt>
        </dl>
    </div>

    <div class="span8">
        <div id='sources_chart'></div>
    </div>
</div>





<script>
    $(function () {
        $('#sources_chart').highcharts({
            chart: {
                type: 'line'
            },
            title: {
                text: 'number of sources'
            },
            xAxis: {
                title: {
                    text: 'Image'
                },
                tickInterval: 1
            },
            yAxis: {
                title: {
                    text: 'number of sources'
                },
                min: 0
            },
            series: [
                {
                    name: '{{ dataset.description }} (ID {{ dataset.id }})',
                    data: [

                        {% for image in images %}
                            {{ image.num_extractedsources }}
                            {% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    ]

                }
            ]
        });
    });
</script>

{% endblock content %}

